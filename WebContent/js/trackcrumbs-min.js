let sMap,latlng,imageTest,crumbImages=[],engineMarkers=new Map,showEngines=0,resetIfNoMarker=!0,currentZoom=13,recentLocations=new Map;recentLocations.set(1,{lat:0,lon:0}),recentLocations.set(2,{lat:0,lon:0}),recentLocations.set(3,{lat:0,lon:0});let santaImage,mapPrepared=!1,shape={coord:[1,1,1,20,18,20,18,1],type:"poly"};function createCrumb(e,n,t){return new google.maps.Marker({position:new google.maps.LatLng(n,t),map:sMap,icon:crumbImages[e-1],zIndex:1})}function importCrumbsFileData(e,n){uniqueID="?d="+Date.now(),e+=uniqueID;let t=new XMLHttpRequest,a=[];t.open("HEAD",e,!0),t.onload=function(){if(404==t.status)return!1;crumbsScript=document.createElement("script"),document.getElementsByTagName("head")[0].appendChild(crumbsScript),crumbsScript.onload=function(){let e="crumbs"+String(n);for(count=0;count<window[e].length-1;count++)count%2==0&&a.push(createCrumb(n,window[e][count].lat,window[e][count].lon));engineMarkers.set(n,a)},crumbsScript.src=e},t.send()}function getCrumbsFileURI(e){return"./location/crumbs-"+e.toString()+".js"}function loadCrumbsFile(e){importCrumbsFileData(getCrumbsFileURI(e),e)}function appendCrumb(e,n,t,a){let o=engineMarkers.get(e);Array.isArray(o)||(o=[]);let s=createCrumb(e,t,a);o.push(s),engineMarkers.set(e,o)}function clearCrumbs(e){let n=engineMarkers.get(e);if(void 0!==n&&0!=n.length){let e=n.length;for(i=0;i<e;i++)n[i].setMap(null),n[i]}}function initRecentLocations(e){recentLocations.get(e).lat=window["lat"+e],recentLocations.get(e).lon=window["lon"+e]}function createMarker(e,n,t){let a=new google.maps.LatLng(n,t);santaMarkers[e-1]=new google.maps.Marker({position:a,map:sMap,icon:santaImage,shape:shape,zIndex:1})}function trackEngines(e){var n,t,a,o,s,r;if(sMap&&(currentZoom=sMap.getZoom(),c=sMap.getCenter()),n=document.getElementById("santa_js"),(t=document.createElement("script")).src="./location/engine1.js?d="+Date.now(),n.parentNode.removeChild(n),t.id="santa_js",document.getElementsByTagName("head")[0].appendChild(t),a=document.getElementById("sparky_js"),(o=document.createElement("script")).src="./location/engine2.js?d="+Date.now(),a.parentNode.removeChild(a),o.id="sparky_js",document.getElementsByTagName("head")[0].appendChild(o),s=document.getElementById("covington_js"),(r=document.createElement("script")).src="./location/engine3.js?d="+Date.now(),s.parentNode.removeChild(s),r.id="covington_js",document.getElementsByTagName("head")[0].appendChild(r),!sMap){var c=new google.maps.LatLng((lat1+lat2)/2,(lon1+lon2)/2),l={zoom:currentZoom,center:c,mapTypeId:google.maps.MapTypeId.ROADMAP};sMap=new google.maps.Map(document.getElementById("map_canvas"),l)}for(i=0;i<3;i++)santaMarkers[i]&&santaMarkers[i].setMap(null);if(e)initRecentLocations(1),initRecentLocations(2),createMarker(1,lat1,lon1),createMarker(2,lat2,lon2);else{0!=showEngines&&1!=showEngines||(recentLocations.get(1).lat==lat1&&recentLocations.get(1).lon==lon1||(appendCrumb(1,!0,recentLocations.get(1).lat,recentLocations.get(1).lon),recentLocations.get(1).lat=lat1,recentLocations.get(1).lon=lon1),createMarker(1,lat1,lon1)),0!=showEngines&&2!=showEngines||(recentLocations.get(2).lat==lat2&&recentLocations.get(2).lon==lon2||(appendCrumb(2,!0,recentLocations.get(2).lat,recentLocations.get(2).lon),recentLocations.get(2).lat=lat2,recentLocations.get(2).lon=lon2),createMarker(2,lat2,lon2)),3==showEngines&&(recentLocations.get(3).lat==lat3&&recentLocations.get(3).lon==lon3||(appendCrumb(showEngines,!0,recentLocations.get(3).lat,recentLocations.get(3).lon),recentLocations.get(3).lat=lat3,recentLocations.get(3).lon=lon3),createMarker(3,lat3,lon3))}if(resetIfNoMarker&&offMap()&&reCenterMap(),!mapPrepared){var g=new Date,p=g.getFullYear(),m=g.getMonth()+1,u=g.getDate();u=p.toString()+m.toString()+u.toString(),engines=["1","2","3","4"],prepareMap(sMap,u,engines),mapPrepared=!0}}function offMap(){return!(!sMap||!sMap.getBounds())&&((0!=showEngines&&1!=showEngines||!sMap.getBounds().contains(santaMarkers[0].getPosition()))&&((0!=showEngines&&2!=showEngines||!sMap.getBounds().contains(santaMarkers[1].getPosition()))&&(3!=showEngines||!sMap.getBounds().contains(santaMarkers[2].getPosition()))))}function reCenterMap(){let e,n;if(0==showEngines?(e=(lat1+lat2)/2,n=(lon1+lon2)/2):1==showEngines?(e=lat1,n=lon1):2==showEngines?(e=lat2,n=lon2):(e=lat3,n=lon3),sMap.panTo(new google.maps.LatLng(e,n)),sMap&&sMap.getBounds())for(;offMap();)sMap.setZoom(sMap.getZoom()-1)}santaMarkers=[];